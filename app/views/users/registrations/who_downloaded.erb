<div class="user-form-container"> 
  <div class="set-size-and-position">
    <div class="blue-header"></div>  
      <div class="container mt-5">     
        <div class="row big_card">  
          <div class="col-lg-12 ">  
            <div class="row">
              <div class="col-md-9 col-lg-8 mx-auto">
                <div class="grid-container">
                  <div class="container-mt5"> 
                    <h4 class="font-weight-light mb-0 align-middle">Who downloaded my Content: <%= @user.name%></h4>
                    <div class="row">
                      <div class="table-responsive">
                      <br>
                        <%@mylogs%>
                        <%@creator%>
                        <% mylogs = Log.where(creator_id: @user.id)%>
                        <table class="table table-striped table-hover user-table mb-0" id="whodownloaded">
                        <thead>
                          <div class="row">
                            <tr>
                              <th class="h5" style="background:none;">Document Name</th>
                              <th class="h5" style="background:none;">Downloaded by (email)</th>
                              <th class="h5" style="background:none;">Downloaded by (name)</th>
                            </tr>
                          </div>
                        </thead>

                        <tbody>
                          <% @mylogs.each do |log| %>
                            <div class="row">
                                <tr>
                                <td data-title="Document Name"><%= log.document.name %></td>
                                <% creator = User.find(log.creator_id)%>
                                <% creator.email%>
                                <td data-title="Document Creator"><%= log.user.email %></td>
                                <td data-title="User Name"><%= log.user.name %></td>
                                </tr>
                            </div>
                          <% end %>
                        </tbody>
                        </table>
                        </div> 

                      <div class="actions form-group p-3">
                        <button class="btn button_user_card" onclick="exportData()">
                          <span class="glyphicon glyphicon-download"></span>
                          Export Report
                        </button>   
                        <%= link_to 'Back', users_path, :class => "btn button_user_card"  %>           
                      </div> <%#actions form-group p-3%>
                    </div> <%#row%>
                    </div> <%#table-responsive %>
                  <%# </div> container-mt5 %>
                </div> <%#grid-container%>
              </div> <%#col-md-9 col-lg-8 mx-auto%>
            </div> <%#row%>
          </div> <%#col-lg-12 %>
        </div> <%# row big_card %>
      </div <%# container mt-5 %>>
  </div> <%# set-size-and-position %>
</div> <%# user-form-container %>

<script>
function exportData(tableID, filename = ''){
    var downloadLink;
    var dataType = 'application/vnd.ms-excel';
    var tableSelect = document.getElementById("whodownloaded");
    var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
    
    // Specify file name
    filename = filename?filename+'.xls':'excel_data.xls';
    
    // Create download link element
    downloadLink = document.createElement("a");
    
    document.body.appendChild(downloadLink);
    
    if(navigator.msSaveOrOpenBlob){
        var blob = new Blob(['\ufeff', tableHTML], {
            type: dataType
        });
        navigator.msSaveOrOpenBlob( blob, filename);
    }else{
        // Create a link to the file
        downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
    
        // Setting the file name
        downloadLink.download = filename;
        
        //triggering the function
        downloadLink.click();
    }
}
</script>