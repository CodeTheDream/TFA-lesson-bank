<%= javascript_pack_tag 'lessons', 'data-turbolinks-track': 'reload' %>

<!-- Lesson Bottom Accordion Section-->
<div class="container  mb-5">
  <% if @lessons.present? %>
    <% @lessons.each do |lessonshow| %>
      <div class="col-lg-12  mb-2 lesson_accordion">
        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="false">
          <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="headingOne">
              <h4 class="panel-title">
                <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne_<%=lessonshow.id%>" aria-expanded="true" aria-controls="collapseOne">
                    <div class=" lesson_title_row  ">
                      <h3><i class="fa fa-solid fa-play icon-play" ></i> Lesson: <%= lessonshow.title.titleize%> </h3>
                    </div>
                </a>
              </h4>
            </div>
            <div id="collapseOne_<%=lessonshow.id%>" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
              <%= form_for([@course,lessonshow]) do |f| %>

                <% if lesson.errors.any? %>
                  <div id="error_explanation" class="my_alert">
                    <h2><%= pluralize(lesson.errors.count, "error") %> prohibited this lesson from being saved:</h2>
                    <ul>
                    <% lesson.errors.full_messages.each do |message| %>
                      <li><%= message %></li>
                    <% end %>
                    </ul>
                  </div>
                <% end %>

                <div class="form-row">
                  <div class="form-group col-sm-4 pl-4">
                    <%= f.label :title %>
                    <%= f.text_field :title, class: 'form-control', :required => true %>
                  </div>
                  <div class="col-sm-1"></div>
                  <div class="col-sm-1">
                    <%= button_tag 'Add Tag', type: 'button', id: 'addTag', onclick: 'addTagField()' %>
                  </div>
                  <br />
                  <div id="TagHeader" style="display:none">
                     Tag Name:
                  </div>
                  <br />
                  <ul id="myList">
                    <% lesson.tags.each do |tag| %>
                      <% time_stamp = Time.now.to_i %>
                      <li><%= text_field :existing_tags, :tag_names["#{time_stamp}"], value: tag.name, class: 'form-control' %></li>
                    <% end %>
                  </ul>
                </div>
                </br>
                <div class="form-group center-right fit-width pl-4">
                  <%= f.label :description %>
                  <%= f.text_area :description, class: 'form-control', :required => true %>
                </div>
                <div class="form-group pl-4">
                  <div class="actions">
                    <%= f.submit %>
                    <% if lesson&.id.present? %>
                      | <%= link_to 'New Document (Lesson)', new_lesson_document_path(lesson.id), :class => "btn btn-outline-primary btn-sm" %>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    <%end%>
  <%end%>
</div>


